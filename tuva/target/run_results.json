{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.7", "generated_at": "2024-02-21T01:36:19.238537Z", "invocation_id": "6d77b9a0-e228-4730-92a4-7a38d02549b1", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-21T01:36:18.755045Z", "completed_at": "2024-02-21T01:36:18.840576Z"}, {"name": "execute", "started_at": "2024-02-21T01:36:18.841514Z", "completed_at": "2024-02-21T01:36:19.080850Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.42403101921081543, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.the_tuva_project.medical_claim", "compiled": true, "compiled_code": "-- models/medical_claim.sql\n\nSELECT DISTINCT\n    REPLACE(JSON_EXTRACT(c, '$.id'), '\"', '') AS claim_id,\n    REPLACE(JSON_EXTRACT(c, '$.item[0].sequence'), '\"', '') AS claim_line_number,\n    REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') AS claim_type,\n    REPLACE(REPLACE(JSON_EXTRACT(c, '$.patient.reference'), '\"Patient/', ''), '\"', '') AS patient_id,\n    NULL AS member_id,\n    REPLACE(JSON_EXTRACT(c, '$.insurance[0].coverage.display'), '\"', '') AS payer,\n    NULL AS plan,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE) AS claim_start_date,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE) AS claim_end_date,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE) AS claim_line_start_date,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE) AS claim_line_end_date,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional'\n        THEN CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE)\n        ELSE NULL\n    END AS admission_date,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional'\n        THEN CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE)\n        ELSE NULL\n    END AS discharge_date,\n    '3' AS admit_source_code,\n    9 AS admit_type_code,\n    CASE\n        WHEN JSON_EXTRACT(pat, '$.deceasedDateTime') IS NOT NULL THEN 20\n        ELSE 1\n    END AS discharge_disposition_code,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional'\n        THEN REPLACE(JSON_EXTRACT(e, '$.item[0].locationCodeableConcept.coding[0].code'), '\"', '')\n        ELSE NULL\n    END AS place_of_service_code,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional' THEN '111'\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional' THEN '791'\n        ELSE NULL\n    END AS bill_type_code,\n    msdrg.\"MS-DRG\" AS ms_drg_code,\n    MAX(aprdrg.apr_drg_code) AS apr_drg_code,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional' THEN 0202\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional' THEN 0500\n        ELSE NULL\n    END AS revenue_center_code,\n    NULL AS service_unit_quantity,\n    NULL AS hcpcs_code,\n    NULL AS hcpcs_modifier_1,\n    NULL AS hcpcs_modifier_2,\n    NULL AS hcpcs_modifier_3,\n    NULL AS hcpcs_modifier_4,\n    NULL AS hcpcs_modifier_5,\n    REPLACE(JSON_EXTRACT(pr, '$.identifier[0].value'), '\"', '') AS rendering_npi,\n    NULL AS billing_npi,\n    NULL AS facility_npi,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.created'), 2, 10) AS DATE) AS paid_date,\n    CAST(REPLACE(JSON_EXTRACT(e, '$.payment.amount.value'), '\"', '') AS FLOAT) AS paid_amount,\n    NULL AS allowed_amount,\n    NULL AS charge_amount,\n    ABS(CAST(REPLACE(JSON_EXTRACT(c, '$.total.value'), '\"', '') AS FLOAT) - CAST(REPLACE(JSON_EXTRACT(e, '$.payment.amount.value'), '\"', '') AS FLOAT)) AS coinsurance_amount,\n    NULL AS copayment_amount,\n    NULL AS deductible_amount,\n    CAST(REPLACE(JSON_EXTRACT(c, '$.total.value'), '\"', '') AS FLOAT) AS total_cost_amount,\n    'icd-10-cm' AS diagnosis_code_type,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[0].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[0].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_1,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[1].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[1].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_2,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[2].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[2].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_3,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[3].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[3].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_4,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[4].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[4].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_5,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[5].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[5].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_6,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[6].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[6].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_7,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[7].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[7].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_8,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[8].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[8].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_9,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[9].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[9].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_10,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[10].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[10].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_11,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[11].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[11].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_12,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[12].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[12].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_13,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[13].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[13].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_14,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[14].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[14].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_15,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[15].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[15].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_16,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[16].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[16].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_17,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[17].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[17].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_18,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[18].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[18].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_19,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[19].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[19].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_20,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[20].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[20].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_21,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[21].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[21].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_22,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[22].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[22].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_23,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[23].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[23].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_24,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[24].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[24].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_25,\n    'Y' AS diagnosis_poa_1,\n    'U' AS diagnosis_poa_2,\n    'U' AS diagnosis_poa_3,\n    'U' AS diagnosis_poa_4,\n    'U' AS diagnosis_poa_5,\n    'U' AS diagnosis_poa_6,\n    'U' AS diagnosis_poa_7,\n    'U' AS diagnosis_poa_8,\n    'U' AS diagnosis_poa_9,\n    'U' AS diagnosis_poa_10,\n    'U' AS diagnosis_poa_11,\n    'U' AS diagnosis_poa_12,\n    'U' AS diagnosis_poa_13,\n    'U' AS diagnosis_poa_14,\n    'U' AS diagnosis_poa_15,\n    'U' AS diagnosis_poa_16,\n    'U' AS diagnosis_poa_17,\n    'U' AS diagnosis_poa_18,\n    'U' AS diagnosis_poa_19,\n    'U' AS diagnosis_poa_20,\n    'U' AS diagnosis_poa_21,\n    'U' AS diagnosis_poa_22,\n    'U' AS diagnosis_poa_23,\n    'U' AS diagnosis_poa_24,\n    'U' AS diagnosis_poa_25,\n    'snomed' AS procedure_code_type,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[0].code'), '\"', '') AS procedure_code_1,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[1].code'), '\"', '') AS procedure_code_2,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[2].code'), '\"', '') AS procedure_code_3,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[3].code'), '\"', '') AS procedure_code_4,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[4].code'), '\"', '') AS procedure_code_5,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[5].code'), '\"', '') AS procedure_code_6,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[6].code'), '\"', '') AS procedure_code_7,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[7].code'), '\"', '') AS procedure_code_8,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[8].code'), '\"', '') AS procedure_code_9,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[9].code'), '\"', '') AS procedure_code_10,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[10].code'), '\"', '') AS procedure_code_11,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[11].code'), '\"', '') AS procedure_code_12,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[12].code'), '\"', '') AS procedure_code_13,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[13].code'), '\"', '') AS procedure_code_14,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[14].code'), '\"', '') AS procedure_code_15,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[15].code'), '\"', '') AS procedure_code_16,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[16].code'), '\"', '') AS procedure_code_17,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[17].code'), '\"', '') AS procedure_code_18,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[18].code'), '\"', '') AS procedure_code_19,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[19].code'), '\"', '') AS procedure_code_20,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[20].code'), '\"', '') AS procedure_code_21,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[21].code'), '\"', '') AS procedure_code_22,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[22].code'), '\"', '') AS procedure_code_23,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[23].code'), '\"', '') AS procedure_code_24,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[24].code'), '\"', '') AS procedure_code_25,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_1,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_2,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_3,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_4,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_5,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_6,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_7,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_8,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_9,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_10,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_11,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_12,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_13,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_14,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_15,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_16,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_17,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_18,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_19,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_20,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_21,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_22,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_23,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_24,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_25,\n    'SyntheaFhir' AS data_source\nFROM \"synthea\".\"json\".\"Claim\" c\nLEFT JOIN \"synthea\".\"json\".\"ExplanationOfBenefit\" e ON REPLACE(JSON_EXTRACT(c, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(e, '$.claim.reference'), '\"Claim/', ''), '\"', '')\nLEFT JOIN \"synthea\".\"json\".\"Condition\" co ON REPLACE(JSON_EXTRACT(co, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(c, '$.diagnosis[0].diagnosisReference.reference'), '\"Condition/', ''), '\"', '')\nLEFT JOIN \"synthea\".\"json\".\"Procedure\" p ON REPLACE(JSON_EXTRACT(p, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(c, '$.procedure[0].procedureReference.reference'), '\"Procedure/', ''), '\"', '')\nLEFT JOIN \"synthea\".\"terminology\".\"snomed_icd_10_map\" map ON REPLACE(JSON_EXTRACT(co, '$.code.coding[0].code'), '\"', '') = map.referenced_component_id\nLEFT JOIN \"synthea\".\"reference\".\"icd10cm_to_msdrg_v41\" msdrg ON REPLACE(msdrg.ICD10, '.', '') = map.map_target\nLEFT JOIN \"synthea\".\"terminology\".\"apr_drg\" aprdrg ON aprdrg.mdc_code = msdrg.MDC\nLEFT JOIN \"synthea\".\"json\".\"Practitioner\" pr ON REPLACE(JSON_EXTRACT(pr, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(e, '$.provider.reference'), '\"Practitioner/', ''), '\"', '')\nLEFT JOIN \"synthea\".\"json\".\"Patient\" pat ON REPLACE(JSON_EXTRACT(pat, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(c, '$.patient.reference'), '\"Patient/', ''), '\"', '')\nWHERE REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') != 'pharmacy'\nAND REPLACE(JSON_EXTRACT(c, '$.item[0].sequence'), '\"', '') IS NOT NULL\nGROUP BY\n    REPLACE(JSON_EXTRACT(c, '$.id'), '\"', ''),\n    REPLACE(JSON_EXTRACT(c, '$.item[0].sequence'), '\"', ''),\n    REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', ''),\n    REPLACE(REPLACE(JSON_EXTRACT(c, '$.patient.reference'), '\"Patient/', ''), '\"', ''),\n    REPLACE(JSON_EXTRACT(c, '$.insurance[0].coverage.display'), '\"', ''),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE),\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional'\n        THEN CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE)\n        ELSE NULL\n    END,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional'\n        THEN CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE)\n        ELSE NULL\n    END,\n    CASE\n        WHEN JSON_EXTRACT(pat, '$.deceasedDateTime') IS NOT NULL THEN 20\n        ELSE 1\n    END,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional'\n        THEN REPLACE(JSON_EXTRACT(e, '$.item[0].locationCodeableConcept.coding[0].code'), '\"', '')\n        ELSE NULL\n    END,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional' THEN '111'\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional' THEN '791'\n        ELSE NULL\n    END,\n    msdrg.\"MS-DRG\",\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional' THEN 0202\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional' THEN 0500\n        ELSE NULL\n    END,\n    REPLACE(JSON_EXTRACT(pr, '$.identifier[0].value'), '\"', ''),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.created'), 2, 10) AS DATE),\n    CAST(REPLACE(JSON_EXTRACT(e, '$.payment.amount.value'), '\"', '') AS FLOAT),\n    ABS(CAST(REPLACE(JSON_EXTRACT(c, '$.total.value'), '\"', '') AS FLOAT) - CAST(REPLACE(JSON_EXTRACT(e, '$.payment.amount.value'), '\"', '') AS FLOAT)),\n    CAST(REPLACE(JSON_EXTRACT(c, '$.total.value'), '\"', '') AS FLOAT),\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[0].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[0].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[1].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[1].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[2].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[2].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[3].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[3].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[4].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[4].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[5].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[5].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[6].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[6].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[7].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[7].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[8].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[8].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[9].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[9].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[10].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[10].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[11].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[11].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[12].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[12].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[13].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[13].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[14].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[14].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[15].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[15].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[16].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[16].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[17].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[17].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[18].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[18].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[19].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[19].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[20].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[20].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[21].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[21].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[22].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[22].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[23].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[23].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[24].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[24].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[0].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[1].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[2].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[3].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[4].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[5].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[6].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[7].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[8].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[9].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[10].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[11].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[12].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[13].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[14].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[15].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[16].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[17].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[18].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[19].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[20].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[21].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[22].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[23].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[24].code'), '\"', ''),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE)\n\nUNION\n\nSELECT DISTINCT\n    REPLACE(JSON_EXTRACT(c, '$.id'), '\"', '') AS claim_id,\n    REPLACE(JSON_EXTRACT(c, '$.item[1].sequence'), '\"', '') AS claim_line_number,\n    REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') AS claim_type,\n    REPLACE(REPLACE(JSON_EXTRACT(c, '$.patient.reference'), '\"Patient/', ''), '\"', '') AS patient_id,\n    NULL AS member_id,\n    REPLACE(JSON_EXTRACT(c, '$.insurance[0].coverage.display'), '\"', '') AS payer,\n    NULL AS plan,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE) AS claim_start_date,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE) AS claim_end_date,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE) AS claim_line_start_date,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE) AS claim_line_end_date,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional'\n        THEN CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE)\n        ELSE NULL\n    END AS admission_date,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional'\n        THEN CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE)\n        ELSE NULL\n    END AS discharge_date,\n    '3' AS admit_source_code,\n    9 AS admit_type_code,\n    CASE\n        WHEN JSON_EXTRACT(pat, '$.deceasedDateTime') IS NOT NULL THEN 20\n        ELSE 1\n    END AS discharge_disposition_code,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional'\n        THEN REPLACE(JSON_EXTRACT(e, '$.item[0].locationCodeableConcept.coding[0].code'), '\"', '')\n        ELSE NULL\n    END AS place_of_service_code,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional' THEN '111'\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional' THEN '791'\n        ELSE NULL\n    END AS bill_type_code,\n    msdrg.\"MS-DRG\" AS ms_drg_code,\n    MAX(aprdrg.apr_drg_code) AS apr_drg_code,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional' THEN 0202\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional' THEN 0500\n        ELSE NULL\n    END AS revenue_center_code,\n    NULL AS service_unit_quantity,\n    NULL AS hcpcs_code,\n    NULL AS hcpcs_modifier_1,\n    NULL AS hcpcs_modifier_2,\n    NULL AS hcpcs_modifier_3,\n    NULL AS hcpcs_modifier_4,\n    NULL AS hcpcs_modifier_5,\n    REPLACE(JSON_EXTRACT(pr, '$.identifier[0].value'), '\"', '') AS rendering_npi,\n    NULL AS billing_npi,\n    NULL AS facility_npi,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.created'), 2, 10) AS DATE) AS paid_date,\n    CAST(REPLACE(JSON_EXTRACT(e, '$.payment.amount.value'), '\"', '') AS FLOAT) AS paid_amount,\n    NULL AS allowed_amount,\n    NULL AS charge_amount,\n    ABS(CAST(REPLACE(JSON_EXTRACT(c, '$.total.value'), '\"', '') AS FLOAT) - CAST(REPLACE(JSON_EXTRACT(e, '$.payment.amount.value'), '\"', '') AS FLOAT)) AS coinsurance_amount,\n    NULL AS copayment_amount,\n    NULL AS deductible_amount,\n    CAST(REPLACE(JSON_EXTRACT(c, '$.total.value'), '\"', '') AS FLOAT) AS total_cost_amount,\n    'icd-10-cm' AS diagnosis_code_type,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[0].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[0].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_1,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[1].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[1].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_2,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[2].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[2].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_3,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[3].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[3].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_4,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[4].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[4].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_5,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[5].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[5].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_6,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[6].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[6].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_7,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[7].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[7].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_8,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[8].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[8].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_9,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[9].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[9].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_10,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[10].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[10].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_11,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[11].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[11].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_12,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[12].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[12].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_13,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[13].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[13].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_14,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[14].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[14].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_15,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[15].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[15].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_16,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[16].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[16].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_17,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[17].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[17].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_18,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[18].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[18].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_19,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[19].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[19].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_20,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[20].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[20].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_21,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[21].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[21].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_22,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[22].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[22].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_23,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[23].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[23].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_24,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[24].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[24].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_25,\n    'Y' AS diagnosis_poa_1,\n    'U' AS diagnosis_poa_2,\n    'U' AS diagnosis_poa_3,\n    'U' AS diagnosis_poa_4,\n    'U' AS diagnosis_poa_5,\n    'U' AS diagnosis_poa_6,\n    'U' AS diagnosis_poa_7,\n    'U' AS diagnosis_poa_8,\n    'U' AS diagnosis_poa_9,\n    'U' AS diagnosis_poa_10,\n    'U' AS diagnosis_poa_11,\n    'U' AS diagnosis_poa_12,\n    'U' AS diagnosis_poa_13,\n    'U' AS diagnosis_poa_14,\n    'U' AS diagnosis_poa_15,\n    'U' AS diagnosis_poa_16,\n    'U' AS diagnosis_poa_17,\n    'U' AS diagnosis_poa_18,\n    'U' AS diagnosis_poa_19,\n    'U' AS diagnosis_poa_20,\n    'U' AS diagnosis_poa_21,\n    'U' AS diagnosis_poa_22,\n    'U' AS diagnosis_poa_23,\n    'U' AS diagnosis_poa_24,\n    'U' AS diagnosis_poa_25,\n    'snomed' AS procedure_code_type,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[0].code'), '\"', '') AS procedure_code_1,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[1].code'), '\"', '') AS procedure_code_2,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[2].code'), '\"', '') AS procedure_code_3,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[3].code'), '\"', '') AS procedure_code_4,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[4].code'), '\"', '') AS procedure_code_5,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[5].code'), '\"', '') AS procedure_code_6,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[6].code'), '\"', '') AS procedure_code_7,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[7].code'), '\"', '') AS procedure_code_8,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[8].code'), '\"', '') AS procedure_code_9,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[9].code'), '\"', '') AS procedure_code_10,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[10].code'), '\"', '') AS procedure_code_11,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[11].code'), '\"', '') AS procedure_code_12,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[12].code'), '\"', '') AS procedure_code_13,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[13].code'), '\"', '') AS procedure_code_14,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[14].code'), '\"', '') AS procedure_code_15,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[15].code'), '\"', '') AS procedure_code_16,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[16].code'), '\"', '') AS procedure_code_17,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[17].code'), '\"', '') AS procedure_code_18,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[18].code'), '\"', '') AS procedure_code_19,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[19].code'), '\"', '') AS procedure_code_20,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[20].code'), '\"', '') AS procedure_code_21,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[21].code'), '\"', '') AS procedure_code_22,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[22].code'), '\"', '') AS procedure_code_23,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[23].code'), '\"', '') AS procedure_code_24,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[24].code'), '\"', '') AS procedure_code_25,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_1,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_2,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_3,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_4,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_5,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_6,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_7,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_8,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_9,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_10,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_11,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_12,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_13,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_14,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_15,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_16,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_17,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_18,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_19,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_20,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_21,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_22,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_23,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_24,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_25,\n    'SyntheaFhir' AS data_source\nFROM \"synthea\".\"json\".\"Claim\" c\nLEFT JOIN \"synthea\".\"json\".\"ExplanationOfBenefit\" e ON REPLACE(JSON_EXTRACT(c, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(e, '$.claim.reference'), '\"Claim/', ''), '\"', '')\nLEFT JOIN \"synthea\".\"json\".\"Condition\" co ON REPLACE(JSON_EXTRACT(co, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(c, '$.diagnosis[1].diagnosisReference.reference'), '\"Condition/', ''), '\"', '')\nLEFT JOIN \"synthea\".\"json\".\"Procedure\" p ON REPLACE(JSON_EXTRACT(p, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(c, '$.procedure[1].procedureReference.reference'), '\"Procedure/', ''), '\"', '')\nLEFT JOIN \"synthea\".\"terminology\".\"snomed_icd_10_map\" map ON REPLACE(JSON_EXTRACT(co, '$.code.coding[0].code'), '\"', '') = map.referenced_component_id\nLEFT JOIN \"synthea\".\"reference\".\"icd10cm_to_msdrg_v41\" msdrg ON REPLACE(msdrg.ICD10, '.', '') = map.map_target\nLEFT JOIN \"synthea\".\"terminology\".\"apr_drg\" aprdrg ON aprdrg.mdc_code = msdrg.MDC\nLEFT JOIN \"synthea\".\"json\".\"Practitioner\" pr ON REPLACE(JSON_EXTRACT(pr, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(e, '$.provider.reference'), '\"Practitioner/', ''), '\"', '')\nLEFT JOIN \"synthea\".\"json\".\"Patient\" pat ON REPLACE(JSON_EXTRACT(pat, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(c, '$.patient.reference'), '\"Patient/', ''), '\"', '')\nWHERE REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') != 'pharmacy'\nAND REPLACE(JSON_EXTRACT(c, '$.item[1].sequence'), '\"', '') IS NOT NULL\nGROUP BY\n    REPLACE(JSON_EXTRACT(c, '$.id'), '\"', ''),\n    REPLACE(JSON_EXTRACT(c, '$.item[1].sequence'), '\"', ''),\n    REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', ''),\n    REPLACE(REPLACE(JSON_EXTRACT(c, '$.patient.reference'), '\"Patient/', ''), '\"', ''),\n    REPLACE(JSON_EXTRACT(c, '$.insurance[0].coverage.display'), '\"', ''),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE),\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional'\n        THEN CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE)\n        ELSE NULL\n    END,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional'\n        THEN CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE)\n        ELSE NULL\n    END,\n    CASE\n        WHEN JSON_EXTRACT(pat, '$.deceasedDateTime') IS NOT NULL THEN 20\n        ELSE 1\n    END,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional'\n        THEN REPLACE(JSON_EXTRACT(e, '$.item[0].locationCodeableConcept.coding[0].code'), '\"', '')\n        ELSE NULL\n    END,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional' THEN '111'\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional' THEN '791'\n        ELSE NULL\n    END,\n    msdrg.\"MS-DRG\",\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional' THEN 0202\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional' THEN 0500\n        ELSE NULL\n    END,\n    REPLACE(JSON_EXTRACT(pr, '$.identifier[0].value'), '\"', ''),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.created'), 2, 10) AS DATE),\n    CAST(REPLACE(JSON_EXTRACT(e, '$.payment.amount.value'), '\"', '') AS FLOAT),\n    ABS(CAST(REPLACE(JSON_EXTRACT(c, '$.total.value'), '\"', '') AS FLOAT) - CAST(REPLACE(JSON_EXTRACT(e, '$.payment.amount.value'), '\"', '') AS FLOAT)),\n    CAST(REPLACE(JSON_EXTRACT(c, '$.total.value'), '\"', '') AS FLOAT),\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[0].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[0].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[1].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[1].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[2].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[2].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[3].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[3].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[4].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[4].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[5].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[5].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[6].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[6].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[7].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[7].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[8].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[8].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[9].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[9].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[10].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[10].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[11].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[11].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[12].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[12].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[13].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[13].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[14].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[14].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[15].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[15].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[16].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[16].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[17].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[17].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[18].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[18].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[19].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[19].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[20].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[20].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[21].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[21].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[22].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[22].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[23].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[23].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[24].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[24].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[0].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[1].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[2].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[3].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[4].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[5].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[6].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[7].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[8].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[9].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[10].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[11].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[12].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[13].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[14].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[15].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[16].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[17].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[18].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[19].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[20].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[21].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[22].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[23].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[24].code'), '\"', ''),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE)\n\nUNION\n\nSELECT DISTINCT\n    REPLACE(JSON_EXTRACT(c, '$.id'), '\"', '') AS claim_id,\n    REPLACE(JSON_EXTRACT(c, '$.item[2].sequence'), '\"', '') AS claim_line_number,\n    REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') AS claim_type,\n    REPLACE(REPLACE(JSON_EXTRACT(c, '$.patient.reference'), '\"Patient/', ''), '\"', '') AS patient_id,\n    NULL AS member_id,\n    REPLACE(JSON_EXTRACT(c, '$.insurance[0].coverage.display'), '\"', '') AS payer,\n    NULL AS plan,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE) AS claim_start_date,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE) AS claim_end_date,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE) AS claim_line_start_date,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE) AS claim_line_end_date,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional'\n        THEN CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE)\n        ELSE NULL\n    END AS admission_date,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional'\n        THEN CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE)\n        ELSE NULL\n    END AS discharge_date,\n    '3' AS admit_source_code,\n    9 AS admit_type_code,\n    CASE\n        WHEN JSON_EXTRACT(pat, '$.deceasedDateTime') IS NOT NULL THEN 20\n        ELSE 1\n    END AS discharge_disposition_code,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional'\n        THEN REPLACE(JSON_EXTRACT(e, '$.item[0].locationCodeableConcept.coding[0].code'), '\"', '')\n        ELSE NULL\n    END AS place_of_service_code,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional' THEN '111'\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional' THEN '791'\n        ELSE NULL\n    END AS bill_type_code,\n    msdrg.\"MS-DRG\" AS ms_drg_code,\n    MAX(aprdrg.apr_drg_code) AS apr_drg_code,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional' THEN 0202\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional' THEN 0500\n        ELSE NULL\n    END AS revenue_center_code,\n    NULL AS service_unit_quantity,\n    NULL AS hcpcs_code,\n    NULL AS hcpcs_modifier_1,\n    NULL AS hcpcs_modifier_2,\n    NULL AS hcpcs_modifier_3,\n    NULL AS hcpcs_modifier_4,\n    NULL AS hcpcs_modifier_5,\n    REPLACE(JSON_EXTRACT(pr, '$.identifier[0].value'), '\"', '') AS rendering_npi,\n    NULL AS billing_npi,\n    NULL AS facility_npi,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.created'), 2, 10) AS DATE) AS paid_date,\n    CAST(REPLACE(JSON_EXTRACT(e, '$.payment.amount.value'), '\"', '') AS FLOAT) AS paid_amount,\n    NULL AS allowed_amount,\n    NULL AS charge_amount,\n    ABS(CAST(REPLACE(JSON_EXTRACT(c, '$.total.value'), '\"', '') AS FLOAT) - CAST(REPLACE(JSON_EXTRACT(e, '$.payment.amount.value'), '\"', '') AS FLOAT)) AS coinsurance_amount,\n    NULL AS copayment_amount,\n    NULL AS deductible_amount,\n    CAST(REPLACE(JSON_EXTRACT(c, '$.total.value'), '\"', '') AS FLOAT) AS total_cost_amount,\n    'icd-10-cm' AS diagnosis_code_type,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[0].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[0].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_1,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[1].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[1].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_2,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[2].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[2].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_3,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[3].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[3].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_4,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[4].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[4].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_5,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[5].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[5].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_6,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[6].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[6].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_7,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[7].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[7].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_8,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[8].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[8].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_9,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[9].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[9].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_10,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[10].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[10].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_11,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[11].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[11].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_12,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[12].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[12].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_13,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[13].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[13].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_14,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[14].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[14].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_15,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[15].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[15].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_16,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[16].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[16].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_17,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[17].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[17].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_18,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[18].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[18].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_19,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[19].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[19].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_20,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[20].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[20].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_21,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[21].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[21].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_22,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[22].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[22].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_23,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[23].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[23].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_24,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[24].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[24].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_25,\n    'Y' AS diagnosis_poa_1,\n    'U' AS diagnosis_poa_2,\n    'U' AS diagnosis_poa_3,\n    'U' AS diagnosis_poa_4,\n    'U' AS diagnosis_poa_5,\n    'U' AS diagnosis_poa_6,\n    'U' AS diagnosis_poa_7,\n    'U' AS diagnosis_poa_8,\n    'U' AS diagnosis_poa_9,\n    'U' AS diagnosis_poa_10,\n    'U' AS diagnosis_poa_11,\n    'U' AS diagnosis_poa_12,\n    'U' AS diagnosis_poa_13,\n    'U' AS diagnosis_poa_14,\n    'U' AS diagnosis_poa_15,\n    'U' AS diagnosis_poa_16,\n    'U' AS diagnosis_poa_17,\n    'U' AS diagnosis_poa_18,\n    'U' AS diagnosis_poa_19,\n    'U' AS diagnosis_poa_20,\n    'U' AS diagnosis_poa_21,\n    'U' AS diagnosis_poa_22,\n    'U' AS diagnosis_poa_23,\n    'U' AS diagnosis_poa_24,\n    'U' AS diagnosis_poa_25,\n    'snomed' AS procedure_code_type,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[0].code'), '\"', '') AS procedure_code_1,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[1].code'), '\"', '') AS procedure_code_2,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[2].code'), '\"', '') AS procedure_code_3,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[3].code'), '\"', '') AS procedure_code_4,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[4].code'), '\"', '') AS procedure_code_5,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[5].code'), '\"', '') AS procedure_code_6,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[6].code'), '\"', '') AS procedure_code_7,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[7].code'), '\"', '') AS procedure_code_8,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[8].code'), '\"', '') AS procedure_code_9,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[9].code'), '\"', '') AS procedure_code_10,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[10].code'), '\"', '') AS procedure_code_11,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[11].code'), '\"', '') AS procedure_code_12,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[12].code'), '\"', '') AS procedure_code_13,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[13].code'), '\"', '') AS procedure_code_14,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[14].code'), '\"', '') AS procedure_code_15,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[15].code'), '\"', '') AS procedure_code_16,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[16].code'), '\"', '') AS procedure_code_17,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[17].code'), '\"', '') AS procedure_code_18,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[18].code'), '\"', '') AS procedure_code_19,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[19].code'), '\"', '') AS procedure_code_20,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[20].code'), '\"', '') AS procedure_code_21,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[21].code'), '\"', '') AS procedure_code_22,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[22].code'), '\"', '') AS procedure_code_23,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[23].code'), '\"', '') AS procedure_code_24,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[24].code'), '\"', '') AS procedure_code_25,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_1,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_2,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_3,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_4,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_5,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_6,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_7,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_8,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_9,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_10,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_11,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_12,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_13,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_14,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_15,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_16,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_17,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_18,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_19,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_20,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_21,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_22,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_23,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_24,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_25,\n    'SyntheaFhir' AS data_source\nFROM \"synthea\".\"json\".\"Claim\" c\nLEFT JOIN \"synthea\".\"json\".\"ExplanationOfBenefit\" e ON REPLACE(JSON_EXTRACT(c, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(e, '$.claim.reference'), '\"Claim/', ''), '\"', '')\nLEFT JOIN \"synthea\".\"json\".\"Condition\" co ON REPLACE(JSON_EXTRACT(co, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(c, '$.diagnosis[2].diagnosisReference.reference'), '\"Condition/', ''), '\"', '')\nLEFT JOIN \"synthea\".\"json\".\"Procedure\" p ON REPLACE(JSON_EXTRACT(p, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(c, '$.procedure[2].procedureReference.reference'), '\"Procedure/', ''), '\"', '')\nLEFT JOIN \"synthea\".\"terminology\".\"snomed_icd_10_map\" map ON REPLACE(JSON_EXTRACT(co, '$.code.coding[0].code'), '\"', '') = map.referenced_component_id\nLEFT JOIN \"synthea\".\"reference\".\"icd10cm_to_msdrg_v41\" msdrg ON REPLACE(msdrg.ICD10, '.', '') = map.map_target\nLEFT JOIN \"synthea\".\"terminology\".\"apr_drg\" aprdrg ON aprdrg.mdc_code = msdrg.MDC\nLEFT JOIN \"synthea\".\"json\".\"Practitioner\" pr ON REPLACE(JSON_EXTRACT(pr, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(e, '$.provider.reference'), '\"Practitioner/', ''), '\"', '')\nLEFT JOIN \"synthea\".\"json\".\"Patient\" pat ON REPLACE(JSON_EXTRACT(pat, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(c, '$.patient.reference'), '\"Patient/', ''), '\"', '')\nWHERE REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') != 'pharmacy'\nAND REPLACE(JSON_EXTRACT(c, '$.item[2].sequence'), '\"', '') IS NOT NULL\nGROUP BY\n    REPLACE(JSON_EXTRACT(c, '$.id'), '\"', ''),\n    REPLACE(JSON_EXTRACT(c, '$.item[2].sequence'), '\"', ''),\n    REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', ''),\n    REPLACE(REPLACE(JSON_EXTRACT(c, '$.patient.reference'), '\"Patient/', ''), '\"', ''),\n    REPLACE(JSON_EXTRACT(c, '$.insurance[0].coverage.display'), '\"', ''),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE),\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional'\n        THEN CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE)\n        ELSE NULL\n    END,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional'\n        THEN CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE)\n        ELSE NULL\n    END,\n    CASE\n        WHEN JSON_EXTRACT(pat, '$.deceasedDateTime') IS NOT NULL THEN 20\n        ELSE 1\n    END,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional'\n        THEN REPLACE(JSON_EXTRACT(e, '$.item[0].locationCodeableConcept.coding[0].code'), '\"', '')\n        ELSE NULL\n    END,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional' THEN '111'\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional' THEN '791'\n        ELSE NULL\n    END,\n    msdrg.\"MS-DRG\",\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional' THEN 0202\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional' THEN 0500\n        ELSE NULL\n    END,\n    REPLACE(JSON_EXTRACT(pr, '$.identifier[0].value'), '\"', ''),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.created'), 2, 10) AS DATE),\n    CAST(REPLACE(JSON_EXTRACT(e, '$.payment.amount.value'), '\"', '') AS FLOAT),\n    ABS(CAST(REPLACE(JSON_EXTRACT(c, '$.total.value'), '\"', '') AS FLOAT) - CAST(REPLACE(JSON_EXTRACT(e, '$.payment.amount.value'), '\"', '') AS FLOAT)),\n    CAST(REPLACE(JSON_EXTRACT(c, '$.total.value'), '\"', '') AS FLOAT),\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[0].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[0].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[1].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[1].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[2].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[2].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[3].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[3].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[4].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[4].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[5].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[5].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[6].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[6].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[7].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[7].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[8].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[8].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[9].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[9].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[10].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[10].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[11].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[11].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[12].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[12].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[13].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[13].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[14].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[14].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[15].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[15].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[16].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[16].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[17].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[17].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[18].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[18].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[19].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[19].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[20].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[20].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[21].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[21].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[22].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[22].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[23].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[23].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[24].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[24].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[0].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[1].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[2].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[3].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[4].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[5].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[6].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[7].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[8].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[9].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[10].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[11].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[12].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[13].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[14].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[15].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[16].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[17].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[18].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[19].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[20].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[21].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[22].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[23].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[24].code'), '\"', ''),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE)\n\nUNION\n\nSELECT DISTINCT\n    REPLACE(JSON_EXTRACT(c, '$.id'), '\"', '') AS claim_id,\n    REPLACE(JSON_EXTRACT(c, '$.item[3].sequence'), '\"', '') AS claim_line_number,\n    REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') AS claim_type,\n    REPLACE(REPLACE(JSON_EXTRACT(c, '$.patient.reference'), '\"Patient/', ''), '\"', '') AS patient_id,\n    NULL AS member_id,\n    REPLACE(JSON_EXTRACT(c, '$.insurance[0].coverage.display'), '\"', '') AS payer,\n    NULL AS plan,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE) AS claim_start_date,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE) AS claim_end_date,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE) AS claim_line_start_date,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE) AS claim_line_end_date,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional'\n        THEN CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE)\n        ELSE NULL\n    END AS admission_date,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional'\n        THEN CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE)\n        ELSE NULL\n    END AS discharge_date,\n    '3' AS admit_source_code,\n    9 AS admit_type_code,\n    CASE\n        WHEN JSON_EXTRACT(pat, '$.deceasedDateTime') IS NOT NULL THEN 20\n        ELSE 1\n    END AS discharge_disposition_code,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional'\n        THEN REPLACE(JSON_EXTRACT(e, '$.item[0].locationCodeableConcept.coding[0].code'), '\"', '')\n        ELSE NULL\n    END AS place_of_service_code,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional' THEN '111'\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional' THEN '791'\n        ELSE NULL\n    END AS bill_type_code,\n    msdrg.\"MS-DRG\" AS ms_drg_code,\n    MAX(aprdrg.apr_drg_code) AS apr_drg_code,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional' THEN 0202\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional' THEN 0500\n        ELSE NULL\n    END AS revenue_center_code,\n    NULL AS service_unit_quantity,\n    NULL AS hcpcs_code,\n    NULL AS hcpcs_modifier_1,\n    NULL AS hcpcs_modifier_2,\n    NULL AS hcpcs_modifier_3,\n    NULL AS hcpcs_modifier_4,\n    NULL AS hcpcs_modifier_5,\n    REPLACE(JSON_EXTRACT(pr, '$.identifier[0].value'), '\"', '') AS rendering_npi,\n    NULL AS billing_npi,\n    NULL AS facility_npi,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.created'), 2, 10) AS DATE) AS paid_date,\n    CAST(REPLACE(JSON_EXTRACT(e, '$.payment.amount.value'), '\"', '') AS FLOAT) AS paid_amount,\n    NULL AS allowed_amount,\n    NULL AS charge_amount,\n    ABS(CAST(REPLACE(JSON_EXTRACT(c, '$.total.value'), '\"', '') AS FLOAT) - CAST(REPLACE(JSON_EXTRACT(e, '$.payment.amount.value'), '\"', '') AS FLOAT)) AS coinsurance_amount,\n    NULL AS copayment_amount,\n    NULL AS deductible_amount,\n    CAST(REPLACE(JSON_EXTRACT(c, '$.total.value'), '\"', '') AS FLOAT) AS total_cost_amount,\n    'icd-10-cm' AS diagnosis_code_type,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[0].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[0].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_1,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[1].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[1].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_2,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[2].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[2].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_3,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[3].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[3].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_4,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[4].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[4].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_5,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[5].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[5].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_6,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[6].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[6].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_7,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[7].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[7].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_8,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[8].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[8].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_9,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[9].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[9].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_10,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[10].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[10].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_11,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[11].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[11].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_12,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[12].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[12].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_13,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[13].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[13].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_14,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[14].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[14].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_15,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[15].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[15].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_16,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[16].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[16].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_17,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[17].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[17].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_18,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[18].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[18].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_19,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[19].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[19].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_20,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[20].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[20].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_21,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[21].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[21].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_22,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[22].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[22].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_23,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[23].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[23].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_24,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[24].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[24].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_25,\n    'Y' AS diagnosis_poa_1,\n    'U' AS diagnosis_poa_2,\n    'U' AS diagnosis_poa_3,\n    'U' AS diagnosis_poa_4,\n    'U' AS diagnosis_poa_5,\n    'U' AS diagnosis_poa_6,\n    'U' AS diagnosis_poa_7,\n    'U' AS diagnosis_poa_8,\n    'U' AS diagnosis_poa_9,\n    'U' AS diagnosis_poa_10,\n    'U' AS diagnosis_poa_11,\n    'U' AS diagnosis_poa_12,\n    'U' AS diagnosis_poa_13,\n    'U' AS diagnosis_poa_14,\n    'U' AS diagnosis_poa_15,\n    'U' AS diagnosis_poa_16,\n    'U' AS diagnosis_poa_17,\n    'U' AS diagnosis_poa_18,\n    'U' AS diagnosis_poa_19,\n    'U' AS diagnosis_poa_20,\n    'U' AS diagnosis_poa_21,\n    'U' AS diagnosis_poa_22,\n    'U' AS diagnosis_poa_23,\n    'U' AS diagnosis_poa_24,\n    'U' AS diagnosis_poa_25,\n    'snomed' AS procedure_code_type,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[0].code'), '\"', '') AS procedure_code_1,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[1].code'), '\"', '') AS procedure_code_2,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[2].code'), '\"', '') AS procedure_code_3,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[3].code'), '\"', '') AS procedure_code_4,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[4].code'), '\"', '') AS procedure_code_5,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[5].code'), '\"', '') AS procedure_code_6,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[6].code'), '\"', '') AS procedure_code_7,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[7].code'), '\"', '') AS procedure_code_8,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[8].code'), '\"', '') AS procedure_code_9,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[9].code'), '\"', '') AS procedure_code_10,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[10].code'), '\"', '') AS procedure_code_11,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[11].code'), '\"', '') AS procedure_code_12,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[12].code'), '\"', '') AS procedure_code_13,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[13].code'), '\"', '') AS procedure_code_14,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[14].code'), '\"', '') AS procedure_code_15,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[15].code'), '\"', '') AS procedure_code_16,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[16].code'), '\"', '') AS procedure_code_17,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[17].code'), '\"', '') AS procedure_code_18,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[18].code'), '\"', '') AS procedure_code_19,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[19].code'), '\"', '') AS procedure_code_20,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[20].code'), '\"', '') AS procedure_code_21,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[21].code'), '\"', '') AS procedure_code_22,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[22].code'), '\"', '') AS procedure_code_23,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[23].code'), '\"', '') AS procedure_code_24,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[24].code'), '\"', '') AS procedure_code_25,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_1,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_2,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_3,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_4,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_5,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_6,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_7,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_8,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_9,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_10,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_11,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_12,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_13,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_14,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_15,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_16,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_17,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_18,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_19,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_20,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_21,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_22,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_23,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_24,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_25,\n    'SyntheaFhir' AS data_source\nFROM \"synthea\".\"json\".\"Claim\" c\nLEFT JOIN \"synthea\".\"json\".\"ExplanationOfBenefit\" e ON REPLACE(JSON_EXTRACT(c, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(e, '$.claim.reference'), '\"Claim/', ''), '\"', '')\nLEFT JOIN \"synthea\".\"json\".\"Condition\" co ON REPLACE(JSON_EXTRACT(co, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(c, '$.diagnosis[3].diagnosisReference.reference'), '\"Condition/', ''), '\"', '')\nLEFT JOIN \"synthea\".\"json\".\"Procedure\" p ON REPLACE(JSON_EXTRACT(p, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(c, '$.procedure[3].procedureReference.reference'), '\"Procedure/', ''), '\"', '')\nLEFT JOIN \"synthea\".\"terminology\".\"snomed_icd_10_map\" map ON REPLACE(JSON_EXTRACT(co, '$.code.coding[0].code'), '\"', '') = map.referenced_component_id\nLEFT JOIN \"synthea\".\"reference\".\"icd10cm_to_msdrg_v41\" msdrg ON REPLACE(msdrg.ICD10, '.', '') = map.map_target\nLEFT JOIN \"synthea\".\"terminology\".\"apr_drg\" aprdrg ON aprdrg.mdc_code = msdrg.MDC\nLEFT JOIN \"synthea\".\"json\".\"Practitioner\" pr ON REPLACE(JSON_EXTRACT(pr, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(e, '$.provider.reference'), '\"Practitioner/', ''), '\"', '')\nLEFT JOIN \"synthea\".\"json\".\"Patient\" pat ON REPLACE(JSON_EXTRACT(pat, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(c, '$.patient.reference'), '\"Patient/', ''), '\"', '')\nWHERE REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') != 'pharmacy'\nAND REPLACE(JSON_EXTRACT(c, '$.item[3].sequence'), '\"', '') IS NOT NULL\nGROUP BY\n    REPLACE(JSON_EXTRACT(c, '$.id'), '\"', ''),\n    REPLACE(JSON_EXTRACT(c, '$.item[3].sequence'), '\"', ''),\n    REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', ''),\n    REPLACE(REPLACE(JSON_EXTRACT(c, '$.patient.reference'), '\"Patient/', ''), '\"', ''),\n    REPLACE(JSON_EXTRACT(c, '$.insurance[0].coverage.display'), '\"', ''),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE),\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional'\n        THEN CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE)\n        ELSE NULL\n    END,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional'\n        THEN CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE)\n        ELSE NULL\n    END,\n    CASE\n        WHEN JSON_EXTRACT(pat, '$.deceasedDateTime') IS NOT NULL THEN 20\n        ELSE 1\n    END,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional'\n        THEN REPLACE(JSON_EXTRACT(e, '$.item[0].locationCodeableConcept.coding[0].code'), '\"', '')\n        ELSE NULL\n    END,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional' THEN '111'\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional' THEN '791'\n        ELSE NULL\n    END,\n    msdrg.\"MS-DRG\",\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional' THEN 0202\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional' THEN 0500\n        ELSE NULL\n    END,\n    REPLACE(JSON_EXTRACT(pr, '$.identifier[0].value'), '\"', ''),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.created'), 2, 10) AS DATE),\n    CAST(REPLACE(JSON_EXTRACT(e, '$.payment.amount.value'), '\"', '') AS FLOAT),\n    ABS(CAST(REPLACE(JSON_EXTRACT(c, '$.total.value'), '\"', '') AS FLOAT) - CAST(REPLACE(JSON_EXTRACT(e, '$.payment.amount.value'), '\"', '') AS FLOAT)),\n    CAST(REPLACE(JSON_EXTRACT(c, '$.total.value'), '\"', '') AS FLOAT),\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[0].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[0].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[1].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[1].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[2].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[2].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[3].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[3].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[4].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[4].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[5].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[5].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[6].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[6].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[7].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[7].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[8].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[8].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[9].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[9].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[10].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[10].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[11].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[11].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[12].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[12].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[13].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[13].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[14].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[14].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[15].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[15].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[16].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[16].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[17].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[17].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[18].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[18].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[19].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[19].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[20].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[20].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[21].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[21].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[22].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[22].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[23].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[23].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[24].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[24].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[0].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[1].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[2].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[3].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[4].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[5].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[6].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[7].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[8].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[9].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[10].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[11].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[12].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[13].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[14].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[15].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[16].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[17].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[18].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[19].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[20].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[21].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[22].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[23].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[24].code'), '\"', ''),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE)\n\nUNION\n\nSELECT DISTINCT\n    REPLACE(JSON_EXTRACT(c, '$.id'), '\"', '') AS claim_id,\n    REPLACE(JSON_EXTRACT(c, '$.item[4].sequence'), '\"', '') AS claim_line_number,\n    REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') AS claim_type,\n    REPLACE(REPLACE(JSON_EXTRACT(c, '$.patient.reference'), '\"Patient/', ''), '\"', '') AS patient_id,\n    NULL AS member_id,\n    REPLACE(JSON_EXTRACT(c, '$.insurance[0].coverage.display'), '\"', '') AS payer,\n    NULL AS plan,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE) AS claim_start_date,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE) AS claim_end_date,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE) AS claim_line_start_date,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE) AS claim_line_end_date,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional'\n        THEN CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE)\n        ELSE NULL\n    END AS admission_date,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional'\n        THEN CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE)\n        ELSE NULL\n    END AS discharge_date,\n    '3' AS admit_source_code,\n    9 AS admit_type_code,\n    CASE\n        WHEN JSON_EXTRACT(pat, '$.deceasedDateTime') IS NOT NULL THEN 20\n        ELSE 1\n    END AS discharge_disposition_code,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional'\n        THEN REPLACE(JSON_EXTRACT(e, '$.item[0].locationCodeableConcept.coding[0].code'), '\"', '')\n        ELSE NULL\n    END AS place_of_service_code,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional' THEN '111'\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional' THEN '791'\n        ELSE NULL\n    END AS bill_type_code,\n    msdrg.\"MS-DRG\" AS ms_drg_code,\n    MAX(aprdrg.apr_drg_code) AS apr_drg_code,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional' THEN 0202\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional' THEN 0500\n        ELSE NULL\n    END AS revenue_center_code,\n    NULL AS service_unit_quantity,\n    NULL AS hcpcs_code,\n    NULL AS hcpcs_modifier_1,\n    NULL AS hcpcs_modifier_2,\n    NULL AS hcpcs_modifier_3,\n    NULL AS hcpcs_modifier_4,\n    NULL AS hcpcs_modifier_5,\n    REPLACE(JSON_EXTRACT(pr, '$.identifier[0].value'), '\"', '') AS rendering_npi,\n    NULL AS billing_npi,\n    NULL AS facility_npi,\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.created'), 2, 10) AS DATE) AS paid_date,\n    CAST(REPLACE(JSON_EXTRACT(e, '$.payment.amount.value'), '\"', '') AS FLOAT) AS paid_amount,\n    NULL AS allowed_amount,\n    NULL AS charge_amount,\n    ABS(CAST(REPLACE(JSON_EXTRACT(c, '$.total.value'), '\"', '') AS FLOAT) - CAST(REPLACE(JSON_EXTRACT(e, '$.payment.amount.value'), '\"', '') AS FLOAT)) AS coinsurance_amount,\n    NULL AS copayment_amount,\n    NULL AS deductible_amount,\n    CAST(REPLACE(JSON_EXTRACT(c, '$.total.value'), '\"', '') AS FLOAT) AS total_cost_amount,\n    'icd-10-cm' AS diagnosis_code_type,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[0].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[0].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_1,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[1].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[1].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_2,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[2].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[2].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_3,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[3].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[3].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_4,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[4].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[4].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_5,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[5].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[5].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_6,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[6].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[6].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_7,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[7].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[7].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_8,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[8].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[8].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_9,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[9].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[9].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_10,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[10].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[10].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_11,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[11].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[11].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_12,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[12].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[12].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_13,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[13].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[13].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_14,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[14].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[14].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_15,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[15].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[15].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_16,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[16].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[16].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_17,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[17].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[17].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_18,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[18].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[18].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_19,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[19].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[19].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_20,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[20].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[20].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_21,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[21].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[21].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_22,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[22].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[22].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_23,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[23].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[23].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_24,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[24].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[24].code') AS VARCHAR), '\"', '')\n        )\n    END AS diagnosis_code_25,\n    'Y' AS diagnosis_poa_1,\n    'U' AS diagnosis_poa_2,\n    'U' AS diagnosis_poa_3,\n    'U' AS diagnosis_poa_4,\n    'U' AS diagnosis_poa_5,\n    'U' AS diagnosis_poa_6,\n    'U' AS diagnosis_poa_7,\n    'U' AS diagnosis_poa_8,\n    'U' AS diagnosis_poa_9,\n    'U' AS diagnosis_poa_10,\n    'U' AS diagnosis_poa_11,\n    'U' AS diagnosis_poa_12,\n    'U' AS diagnosis_poa_13,\n    'U' AS diagnosis_poa_14,\n    'U' AS diagnosis_poa_15,\n    'U' AS diagnosis_poa_16,\n    'U' AS diagnosis_poa_17,\n    'U' AS diagnosis_poa_18,\n    'U' AS diagnosis_poa_19,\n    'U' AS diagnosis_poa_20,\n    'U' AS diagnosis_poa_21,\n    'U' AS diagnosis_poa_22,\n    'U' AS diagnosis_poa_23,\n    'U' AS diagnosis_poa_24,\n    'U' AS diagnosis_poa_25,\n    'snomed' AS procedure_code_type,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[0].code'), '\"', '') AS procedure_code_1,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[1].code'), '\"', '') AS procedure_code_2,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[2].code'), '\"', '') AS procedure_code_3,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[3].code'), '\"', '') AS procedure_code_4,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[4].code'), '\"', '') AS procedure_code_5,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[5].code'), '\"', '') AS procedure_code_6,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[6].code'), '\"', '') AS procedure_code_7,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[7].code'), '\"', '') AS procedure_code_8,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[8].code'), '\"', '') AS procedure_code_9,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[9].code'), '\"', '') AS procedure_code_10,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[10].code'), '\"', '') AS procedure_code_11,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[11].code'), '\"', '') AS procedure_code_12,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[12].code'), '\"', '') AS procedure_code_13,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[13].code'), '\"', '') AS procedure_code_14,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[14].code'), '\"', '') AS procedure_code_15,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[15].code'), '\"', '') AS procedure_code_16,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[16].code'), '\"', '') AS procedure_code_17,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[17].code'), '\"', '') AS procedure_code_18,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[18].code'), '\"', '') AS procedure_code_19,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[19].code'), '\"', '') AS procedure_code_20,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[20].code'), '\"', '') AS procedure_code_21,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[21].code'), '\"', '') AS procedure_code_22,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[22].code'), '\"', '') AS procedure_code_23,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[23].code'), '\"', '') AS procedure_code_24,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[24].code'), '\"', '') AS procedure_code_25,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_1,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_2,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_3,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_4,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_5,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_6,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_7,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_8,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_9,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_10,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_11,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_12,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_13,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_14,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_15,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_16,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_17,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_18,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_19,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_20,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_21,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_22,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_23,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_24,\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE) AS procedure_date_25,\n    'SyntheaFhir' AS data_source\nFROM \"synthea\".\"json\".\"Claim\" c\nLEFT JOIN \"synthea\".\"json\".\"ExplanationOfBenefit\" e ON REPLACE(JSON_EXTRACT(c, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(e, '$.claim.reference'), '\"Claim/', ''), '\"', '')\nLEFT JOIN \"synthea\".\"json\".\"Condition\" co ON REPLACE(JSON_EXTRACT(co, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(c, '$.diagnosis[4].diagnosisReference.reference'), '\"Condition/', ''), '\"', '')\nLEFT JOIN \"synthea\".\"json\".\"Procedure\" p ON REPLACE(JSON_EXTRACT(p, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(c, '$.procedure[4].procedureReference.reference'), '\"Procedure/', ''), '\"', '')\nLEFT JOIN \"synthea\".\"terminology\".\"snomed_icd_10_map\" map ON REPLACE(JSON_EXTRACT(co, '$.code.coding[0].code'), '\"', '') = map.referenced_component_id\nLEFT JOIN \"synthea\".\"reference\".\"icd10cm_to_msdrg_v41\" msdrg ON REPLACE(msdrg.ICD10, '.', '') = map.map_target\nLEFT JOIN \"synthea\".\"terminology\".\"apr_drg\" aprdrg ON aprdrg.mdc_code = msdrg.MDC\nLEFT JOIN \"synthea\".\"json\".\"Practitioner\" pr ON REPLACE(JSON_EXTRACT(pr, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(e, '$.provider.reference'), '\"Practitioner/', ''), '\"', '')\nLEFT JOIN \"synthea\".\"json\".\"Patient\" pat ON REPLACE(JSON_EXTRACT(pat, '$.id'), '\"', '') = REPLACE(REPLACE(JSON_EXTRACT(c, '$.patient.reference'), '\"Patient/', ''), '\"', '')\nWHERE REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') != 'pharmacy'\nAND REPLACE(JSON_EXTRACT(c, '$.item[4].sequence'), '\"', '') IS NOT NULL\nGROUP BY\n    REPLACE(JSON_EXTRACT(c, '$.id'), '\"', ''),\n    REPLACE(JSON_EXTRACT(c, '$.item[4].sequence'), '\"', ''),\n    REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', ''),\n    REPLACE(REPLACE(JSON_EXTRACT(c, '$.patient.reference'), '\"Patient/', ''), '\"', ''),\n    REPLACE(JSON_EXTRACT(c, '$.insurance[0].coverage.display'), '\"', ''),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE),\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional'\n        THEN CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.start'), 2, 10) AS DATE)\n        ELSE NULL\n    END,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional'\n        THEN CAST(SUBSTRING(JSON_EXTRACT(c, '$.billablePeriod.end'), 2, 10) AS DATE)\n        ELSE NULL\n    END,\n    CASE\n        WHEN JSON_EXTRACT(pat, '$.deceasedDateTime') IS NOT NULL THEN 20\n        ELSE 1\n    END,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional'\n        THEN REPLACE(JSON_EXTRACT(e, '$.item[0].locationCodeableConcept.coding[0].code'), '\"', '')\n        ELSE NULL\n    END,\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional' THEN '111'\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional' THEN '791'\n        ELSE NULL\n    END,\n    msdrg.\"MS-DRG\",\n    CASE\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'institutional' THEN 0202\n        WHEN REPLACE(JSON_EXTRACT(c, '$.type.coding[0].code'), '\"', '') = 'professional' THEN 0500\n        ELSE NULL\n    END,\n    REPLACE(JSON_EXTRACT(pr, '$.identifier[0].value'), '\"', ''),\n    CAST(SUBSTRING(JSON_EXTRACT(c, '$.created'), 2, 10) AS DATE),\n    CAST(REPLACE(JSON_EXTRACT(e, '$.payment.amount.value'), '\"', '') AS FLOAT),\n    ABS(CAST(REPLACE(JSON_EXTRACT(c, '$.total.value'), '\"', '') AS FLOAT) - CAST(REPLACE(JSON_EXTRACT(e, '$.payment.amount.value'), '\"', '') AS FLOAT)),\n    CAST(REPLACE(JSON_EXTRACT(c, '$.total.value'), '\"', '') AS FLOAT),\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[0].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[0].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[1].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[1].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[2].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[2].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[3].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[3].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[4].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[4].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[5].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[5].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[6].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[6].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[7].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[7].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[8].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[8].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[9].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[9].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[10].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[10].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[11].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[11].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[12].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[12].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[13].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[13].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[14].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[14].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[15].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[15].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[16].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[16].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[17].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[17].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[18].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[18].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[19].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[19].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[20].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[20].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[21].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[21].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[22].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[22].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[23].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[23].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    CASE\n        WHEN (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[24].code') AS VARCHAR), '\"', '')\n        ) = 'nan' THEN NULL\n        ELSE (\n            SELECT REGEXP_REPLACE(map.map_target, '[^a-zA-Z0-9]', '', 'g')\n            FROM \"synthea\".\"terminology\".\"snomed_icd_10_map\" AS map\n            WHERE map.referenced_component_id = REPLACE(CAST(JSON_EXTRACT(co, '$.code.coding[24].code') AS VARCHAR), '\"', '')\n        )\n    END,\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[0].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[1].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[2].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[3].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[4].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[5].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[6].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[7].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[8].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[9].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[10].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[11].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[12].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[13].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[14].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[15].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[16].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[17].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[18].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[19].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[20].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[21].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[22].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[23].code'), '\"', ''),\n    REPLACE(JSON_EXTRACT(p, '$.code.coding[24].code'), '\"', ''),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE),\n    CAST(SUBSTRING(JSON_EXTRACT(p, '$.performedDateTime'), 2, 10) AS DATE)", "relation_name": "\"synthea\".\"tuva_input\".\"medical_claim\""}], "elapsed_time": 1.0721759796142578, "args": {"populate_cache": true, "send_anonymous_usage_stats": true, "log_file_max_bytes": 10485760, "log_level_file": "debug", "profiles_dir": "/workspaces/synthea_dw/tuva", "write_json": true, "log_format_file": "debug", "print": true, "cache_selected_only": false, "strict_mode": false, "introspect": true, "log_level": "info", "invocation_command": "dbt run -m medical_claim.sql", "use_colors_file": true, "use_colors": true, "indirect_selection": "eager", "favor_state": false, "show_resource_report": false, "static_parser": true, "defer": false, "warn_error_options": {"include": [], "exclude": []}, "partial_parse": true, "project_dir": "/workspaces/synthea_dw/tuva", "printer_width": 80, "vars": {}, "log_path": "/workspaces/synthea_dw/tuva/logs", "which": "run", "select": ["medical_claim.sql"], "quiet": false, "log_format": "default", "exclude": [], "version_check": true, "enable_legacy_logger": false, "partial_parse_file_diff": true, "macro_debugging": false}}