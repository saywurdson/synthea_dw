version: 2

models:
  - name: person
    description: This table serves as the central identity management for all Persons in the database. It contains records that uniquely identify each person or patient, and some demographic information.
    columns:
      - name: person_id
        description: Unique identifier for each person; should be treated independently. Preferably the original id from the source data if it is an integer, otherwise, it can be an autogenerated number.
        tests:
          - unique
          - not_null
      - name: gender_concept_id
        description: Captures the biological sex at birth of the Person. It should not be used to study gender identity issues, which should be stored in the OBSERVATION table if present.
        tests:
          - not_null
      - name: year_of_birth
        description: The year the person was born. Should be derived from date of birth where available.
        tests:
          - not_null
      - name: month_of_birth
        description: The month the person was born. Extracted and stored from date of birth where available.
      - name: day_of_birth
        description: The day the person was born. Extracted and stored from date of birth where available.
      - name: birth_datetime
        description: The precise datetime of birth of the person. Highly encouraged to be provided where available, with fallback logic if certain components (day, month) are unavailable.
      - name: race_concept_id
        description: Captures the race or ethnic background of the person. Use only if this information is available. If a clear race or ethnic background cannot be established, use Concept_Id 0.
        tests:
          - not_null
      - name: ethnicity_concept_id
        description: Captures Ethnicity as defined by the OMB - only distinguishes between 'Hispanic' and 'Not Hispanic'. Do not infer Ethnicity from race or ethnic background.
        tests:
          - not_null
      - name: location_id
        description: Refers to the physical address of the person. Should capture the last known location. Represents the most granular location information for the person.
      - name: provider_id
        description: Refers to the last known primary care provider (General Practitioner) of the person.
      - name: care_site_id
        description: Refers to the care site where the Provider typically provides primary care.
      - name: person_source_value
        description: Used to link back to persons in the source data. Typically used for error checking of ETL logic.
      - name: gender_source_value
        description: Stores the biological sex of the person from the source data. Not intended for use in standard analytics but for reference only.
      - name: gender_source_concept_id
        description: Stores the concept_id of the biological sex from the source data if it uses a non-standard vocabulary.
      - name: race_source_value
        description: Stores the race of the person as it appears in the source data. Not intended for use in standard analytics but for reference only.
      - name: race_source_concept_id
        description: Stores the concept_id of the race from the source data if it uses an OMOP supported vocabulary.
      - name: ethnicity_source_value
        description: Stores the ethnicity of the person from the source data. Not intended for use in standard analytics but for reference only.
      - name: ethnicity_source_concept_id
        description: Stores the concept_id of the ethnicity from the source data if it uses an OMOP supported vocabulary.
  
  - name: visit_occurrence
    description: This table contains Events where Persons engage with the healthcare system for a duration of time, often also called “Encounters”. Visits are defined by a configuration of circumstances such as whether the patient visits a healthcare institution, the visit is remote, the type of trained medical staff delivering the service, and the duration of the visit (transient or extended with a stay in bed).
    columns:
      - name: visit_occurrence_id
        description: Unique identifier for each interaction between a person and the healthcare system, linking across other event tables to associate events with a visit.
        tests:
          - unique
          - not_null
      - name: person_id
        description: Identifier of the person engaging in the healthcare system visit.
        tests:
          - not_null
      - name: visit_concept_id
        description: Represents the type of visit (inpatient, outpatient, etc.) using standard concepts in the Visit domain.
        tests:
          - not_null
      - name: visit_start_date
        description: The date when the visit started, varying by visit type (e.g., admission date for inpatient visits).
        tests:
          - not_null
      - name: visit_start_datetime
        description: The precise starting datetime of the visit, defaulting to midnight if not specified.
      - name: visit_end_date
        description: The date when the visit ended, varying by visit type and specific rules for ongoing visits or lack of end date data.
        tests:
          - not_null
      - name: visit_end_datetime
        description: The precise ending datetime of the visit, with specific handling for ongoing visits or lack of specific end time data.
      - name: visit_type_concept_id
        description: Use this field to understand the provenance of the visit record, or where the record comes from.
        tests:
          - not_null
      - name: provider_id
        description: There will only be one provider per visit record and the ETL document should clearly state how they were chosen.
      - name: care_site_id
        description: This field provides information about the Care Site where the Visit took place.
      - name: visit_source_value
        description: This field houses the verbatim value from the source data representing the kind of visit that took place.
      - name: visit_source_concept_id
        description: If the visit source value is coded in the source data using an OMOP supported vocabulary put the concept id representing the source value here.
      - name: admitted_from_concept_id
        description: Use this field to determine where the patient was admitted from.
      - name: admitted_from_source_value
        description: This information may be called something different in the source data but the field is meant to contain a value indicating where a person was admitted from.
      - name: discharged_to_concept_id
        description: Use this field to determine where the patient was discharged to after a visit.
      - name: discharged_to_source_value
        description: This information may be called something different in the source data but the field is meant to contain a value indicating where a person was discharged to after a visit.
      - name: preceding_visit_occurrence_id
        description: Use this field to find the visit that occurred for the person prior to the given visit.
  
  - name: condition_occurrence
    description: This table contains records of Events of a Person suggesting the presence of a disease or medical condition stated as a diagnosis, a sign, or a symptom, which is either observed by a Provider or reported by the patient.
    columns:
      - name: condition_occurrence_id
        description: The unique key given to a condition record for a person. Refer to the ETL for how duplicate conditions during the same visit were handled.
        tests:
          - unique
          - not_null
      - name: person_id
        description: The PERSON_ID of the PERSON for whom the condition is recorded.
        tests:
          - not_null
      - name: condition_concept_id
        description: The CONDITION_CONCEPT_ID field is recommended for primary use in analyses, and must be used for network studies. This is the standard concept mapped from the source value which represents a condition.
        tests:
          - not_null
      - name: condition_start_date
        description: Use this date to determine the start date of the condition.
        tests:
          - not_null
      - name: condition_start_datetime
      - name: condition_end_date
        description: Use this date to determine the end date of the condition.
      - name: condition_end_datetime
      - name: condition_type_concept_id
        description: This field can be used to determine the provenance of the Condition record, as in whether the condition was from an EHR system, insurance claim, registry, or other sources.
        tests:
          - not_null
      - name: condition_status_concept_id
        description: This concept represents the point during the visit the diagnosis was given (admitting diagnosis, final diagnosis), whether the diagnosis was determined due to laboratory findings, if the diagnosis was exclusionary, or if it was a preliminary diagnosis, among others.
      - name: stop_reason
        description: The Stop Reason indicates why a Condition is no longer valid with respect to the purpose within the source data. Note that a Stop Reason does not necessarily imply that the condition is no longer occurring.
      - name: provider_id
        description: The provider associated with condition record, e.g. the provider who made the diagnosis or the provider who recorded the symptom.
      - name: visit_occurrence_id
        description: The visit during which the condition occurred.
      - name: visit_detail_id
        description: The VISIT_DETAIL record during which the condition occurred. For example, if the person was in the ICU at the time of the diagnosis the VISIT_OCCURRENCE record would reflect the overall hospital stay and the VISIT_DETAIL record would reflect the ICU stay during the hospital visit.
      - name: condition_source_value
        description: This field houses the verbatim value from the source data representing the condition that occurred. For example, this could be an ICD10 or Read code.
      - name: condition_source_concept_id
        description: This is the concept representing the condition source value and may not necessarily be standard. This field is discouraged from use in analysis because it is not required to contain Standard Concepts that are used across the OHDSI community, and should only be used when Standard Concepts do not adequately represent the source detail for the Condition necessary for a given analytic use case. Consider using CONDITION_CONCEPT_ID instead to enable standardized analytics that can be consistent across the network.
      - name: condition_status_source_value
        description: This field houses the verbatim value from the source data representing the condition status.
  
  - name: drug_exposure
    description: This table captures records about the exposure to a Drug ingested or otherwise introduced into the body. A Drug is a biochemical substance formulated in such a way that when administered to a Person it will exert a certain biochemical effect on the metabolism. Drugs include prescription and over-the-counter medicines, vaccines, and large-molecule biologic therapies. Radiological devices ingested or applied locally do not count as Drugs.
    columns:
      - name: drug_exposure_id
        description: The unique key given to records of drug dispensings or administrations for a person.
        tests:
          - unique
          - not_null
      - name: person_id
        description: The PERSON_ID of the PERSON for whom the drug dispensing or administration is recorded.
        tests:
          - not_null
      - name: drug_concept_id
        description: The standard concept mapped from the source concept id which represents a drug product or molecule otherwise introduced to the body.
        tests:
          - not_null
      - name: drug_exposure_start_date
        description: Use this date to determine the start date of the drug record.
        tests:
          - not_null
      - name: drug_exposure_start_datetime
        description: This is not required, though it is in v6. If a source does not specify datetime the convention is to set the time to midnight (00:00:0000).
      - name: drug_exposure_end_date
        description: The day the drug exposure ended for the patient.
        tests:
          - not_null
      - name: drug_exposure_end_datetime
        description: This is not required, though it is in v6. If a source does not specify datetime the convention is to set the time to midnight (00:00:0000).
      - name: verbatim_end_date
        description: The end date of the drug exposure as it appears in the source data, if it is given.
      - name: drug_type_concept_id
        description: Use the TYPE_CONCEPT_ID to delineate between prescriptions written vs. prescriptions dispensed vs. medication history vs. patient-reported exposure, etc.
        tests:
          - not_null
      - name: stop_reason
        description: The reason a person stopped a medication as it is represented in the source.
      - name: refills
        description: This is only filled in when the record is coming from a prescription written this field is meant to represent intended refills at time of the prescription.
      - name: quantity
        description: The total amount dispensed or ordered of the drug, with the units given by the drug_strength table or the number of units/tablets/capsules prescribed or dispensed.
      - name: days_supply
        description: Days supply of the drug. This should be the verbatim days_supply as given on the prescription.
      - name: sig
        description: The verbatim instruction for the drug as written by the provider.
      - name: route_concept_id
        description: The standard CONCEPT_ID that the ROUTE_SOURCE_VALUE maps to in the route domain.
      - name: lot_number
        description: Typically used for tracking, especially in the case of a recall of the drug.
      - name: provider_id
        description: The Provider associated with drug record, e.g., the provider who wrote the prescription or the provider who administered the drug.
      - name: visit_occurrence_id
        description: The Visit during which the drug was prescribed, administered or dispensed.
      - name: visit_detail_id
        description: The VISIT_DETAIL record during which the drug exposure occurred.
      - name: drug_source_value
        description: This field houses the verbatim value from the source data representing the drug exposure that occurred.
      - name: drug_source_concept_id
        description: This is the concept representing the drug source value and may not necessarily be standard.
      - name: route_source_value
        description: This field houses the verbatim value from the source data representing the drug route.
      - name: dose_unit_source_value
        description: This field houses the verbatim value from the source data representing the dose unit of the drug given.
  
  - name: procedure_occurrence
    description: This table contains records of activities or processes ordered by, or carried out by, a healthcare provider on the patient with a diagnostic or therapeutic purpose.
    columns:
      - name: procedure_occurrence_id
        description: The unique key given to a procedure record for a person.
        tests:
        - unique
        - not_null
      - name: person_id
        description: The PERSON_ID of the PERSON for whom the procedure is recorded.
        tests:
        - not_null
      - name: procedure_concept_id
        description: The standard concept mapped from the source value which represents a procedure.
        tests:
        - not_null
      - name: procedure_date
        description: The date the procedure started.
        tests:
        - not_null
      - name: procedure_datetime
        description: The datetime the procedure started.
      - name: procedure_end_date
        description: The date that the procedure ended.
      - name: procedure_end_datetime
        description: The datetime that the procedure ended.
      - name: procedure_type_concept_id
        description: The concept that best represents the provenance of the record.
        tests:
        - not_null
      - name: modifier_concept_id
        description: The concept that gives additional information about the procedure.
      - name: quantity
        description: The quantity of the procedure.
      - name: provider_id
        description: The provider associated with the procedure record.
      - name: visit_occurrence_id
        description: The visit during which the procedure occurred.
      - name: visit_detail_id
        description: The VISIT_DETAIL record during which the Procedure occurred.
      - name: procedure_source_value
        description: The verbatim value from the source data representing the procedure that occurred.
      - name: procedure_source_concept_id
        description: The concept representing the procedure source value.
      - name: modifier_source_value
        description: The original modifier code from the source.
  
  - name: device_exposure
    description: The Device domain captures information about a person’s exposure to a foreign physical object or instrument which is used for diagnostic or therapeutic purposes through a mechanism beyond chemical action.
    columns:
      - name: device_exposure_id
        description: The unique key given to records a person’s exposure to a foreign physical object or instrument.
        tests:
          - unique
          - not_null
      - name: person_id
        tests:
          - not_null
      - name: device_concept_id
        description: The standard concept mapped from the source concept id which represents a foreign object or instrument the person was exposed to.
        tests:
          - not_null
      - name: device_exposure_start_date
        description: The start date of the device record.
        tests:
          - not_null
      - name: device_exposure_start_datetime
      - name: device_exposure_end_date
        description: The day the device exposure ended for the patient, if given.
      - name: device_exposure_end_datetime
      - name: device_type_concept_id
        description: Denotes the provenance of the record, as in whether the record is from administrative claims or EHR.
        tests:
          - not_null
      - name: unique_device_id
        description: The Unique Device Identification (UDI-DI) number for devices regulated by the FDA, if given.
      - name: provider_id
        description: The Provider associated with device record, e.g. the provider who wrote the prescription or the provider who implanted the device.
      - name: visit_occurrence_id
        description: The Visit during which the device was prescribed or given.
      - name: device_source_value
        description: The verbatim value from the source data representing the device exposure that occurred.
      - name: device_source_concept_id
        description: The concept representing the device source value and may not necessarily be standard.
  
  - name: measurement
    description: The MEASUREMENT table captures the structured results of a Measurement, i.e. structured values obtained through systematic and standardized examination or testing of a Person or sample.
    columns:
      - name: measurement_id
        description: A unique identifier for each Measurement.
        tests:
          - unique
          - not_null
      - name: person_id
        description: A foreign key identifier to the Person who is subjected to the Measurement. The demographic details of that Person are stored in the PERSON table.
        tests:
          - not_null
      - name: measurement_concept_id
        description: A foreign key that refers to a standard Measurement Concept identifier in the Standardized Vocabularies.
        tests:
          - not_null
      - name: measurement_date
        description: The date of the Measurement.
        tests:
          - not_null
      - name: measurement_datetime
        description: The date and time of the Measurement.
      - name: measurement_type_concept_id
        description: A foreign key to the predefined Concept in the Standardized Vocabularies reflecting the type of the Measurement.
        tests:
          - not_null
      - name: operator_concept_id
        description: A foreign key to a predefined Concept in the Standardized Vocabularies reflecting the operator of the Measurement.
      - name: value_as_number
        description: The result of the Measurement as a numeric value.
      - name: value_as_concept_id
        description: A foreign key to a predefined Concept in the Standardized Vocabularies reflecting the value of the Measurement as a Concept.
      - name: unit_concept_id
        description: A foreign key to a predefined Concept in the Standardized Vocabularies reflecting the unit of the Measurement.
      - name: range_low
        description: The lower limit of normal for the Measurement.
      - name: range_high
        description: The upper limit of normal for the Measurement.
      - name: provider_id
        description: A foreign key to the provider in the PROVIDER table who recorded the Measurement.
      - name: visit_occurrence_id
        description: A foreign key to the visit in the VISIT_OCCURRENCE table during which the Measurement was recorded.
      - name: measurement_source_value
        description: The source code for the Measurement as it appears in the source data. This code is mapped to a standard Measurement Concept in the Standardized Vocabularies and the original code is stored here for reference.
      - name: measurement_source_concept_id
        description: A foreign key to a Measurement Concept that refers to the code used in the source.
  
  - name: observation
    description: The OBSERVATION table captures clinical facts about a Person obtained in the course of examination, questioning or performing Tests on the Person.
    columns:
      - name: observation_id
        description: A unique identifier for each Observation.
        tests:
        - unique
        - not_null
      - name: person_id
        description: A foreign key identifier to the Person who is subjected to the Observation. The demographic details of that Person are stored in the PERSON table.
        tests:
        - not_null
      - name: observation_concept_id
        description: A foreign key that refers to a standard Observation Concept identifier in the Standardized Vocabularies.
        tests:
        - not_null
      - name: observation_date
        description: The date of the Observation.
        tests:
        - not_null
      - name: observation_datetime
        description: The date and time of the Observation.
      - name: observation_type_concept_id
        description: A foreign key to the predefined Concept in the Standardized Vocabularies reflecting the type of the Observation.
        tests:
        - not_null
      - name: value_as_number
        description: The result of the Observation as a numeric value.
      - name: value_as_string
        description: The result of the Observation as a string value.
      - name: value_as_concept_id
        description: A foreign key to a predefined Concept in the Standardized Vocabularies reflecting the value of the Observation as a Concept.
      - name: qualifier_concept_id
        description: A foreign key to a predefined Concept in the Standardized Vocabularies reflecting additional detail about the value of the Observation.
      - name: unit_concept_id
        description: A foreign key to a predefined Concept in the Standardized Vocabularies reflecting the unit of the Observation.
      - name: provider_id
        description: A foreign key to the provider in the PROVIDER table who recorded the Observation.
      - name: visit_occurrence_id
        description: A foreign key to the visit in the VISIT_OCCURRENCE table during which the Observation was recorded.
      - name: observation_source_value
        description: The source code for the Observation as it appears in the source data. This code is mapped to a standard Observation Concept in the Standardized Vocabularies and the original code is stored here for reference.
      - name: observation_source_concept_id
        description: A foreign key to an Observation Concept that refers to the code used in the source.
  
  - name: location
    description: The LOCATION table represents a generic way to capture physical location or address information of Persons and Care Sites.
    columns:
      - name: location_id
        description: The unique key given to a unique Location. Each instance of a Location in the source data should be assigned this unique key.
        tests:
          - unique
          - not_null
      - name: address_1
        description: This is the first line of the address.
      - name: address_2
        description: This is the second line of the address.
      - name: city
      - name: state
      - name: zip
        description: Zip codes are handled as strings of up to 9 characters length. For US addresses, these represent either a 3-digit abbreviated Zip code as provided by many sources for patient protection reasons, the full 5-digit Zip or the 9-digit (ZIP + 4) codes. Unless for specific reasons analytical methods should expect and utilize only the first 3 digits. For international addresses, different rules apply.
      - name: county
      - name: location_source_value
        description: Put the verbatim value for the location here, as it shows up in the source.
      - name: country_concept_id
        description: The Concept Id representing the country. Values should conform to the Geography domain.
      - name: country_source_value
        description: The name of the country.
      - name: latitude
        description: Must be between -90 and 90.
      - name: longitude
        description: Must be between -180 and 180.
  
  - name: care_site
    description: The CARE_SITE table contains a list of uniquely identified institutional (physical or organizational) units where healthcare delivery is practiced (offices, wards, hospitals, clinics, etc.).
    columns:
      - name: care_site_id
        tests:
          - unique
          - not_null
      - name: care_site_name
        description: The name of the care_site as it appears in the source data.
      - name: place_of_service_concept_id
        description: This is a high-level way of characterizing a Care Site. Typically, however, Care Sites can provide care in multiple settings (inpatient, outpatient, etc.) and this granularity should be reflected in the visit.
      - name: location_id
        description: The location_id from the LOCATION table representing the physical location of the care_site.
      - name: care_site_source_value
        description: The identifier of the care_site as it appears in the source data. This could be an identifier separate from the name of the care_site.
      - name: place_of_service_source_value
        description: Put the place of service of the care_site as it appears in the source data.

  - name: provider
    description: The PROVIDER table contains a list of uniquely identified healthcare providers. These are individuals providing hands-on healthcare to patients, such as physicians, nurses, midwives, physical therapists etc.
    columns:
      - name: provider_id
        description: It is assumed that every provider with a different unique identifier is in fact a different person and should be treated independently.
        tests:
        - unique
        - not_null
      - name: provider_name
        description: The name of the Provider.
      - name: npi
        description: This is the National Provider Number issued to health care providers in the US by the Centers for Medicare and Medicaid Services (CMS).
      - name: dea
        description: 	This is the identifier issued by the DEA, a US federal agency, that allows a provider to write prescriptions for controlled substances.
      - name: specialty_concept_id
        description: 	This field either represents the most common specialty that occurs in the data or the most specific concept that represents all specialties listed, should the provider have more than one. This includes physician specialties such as internal medicine, emergency medicine, etc. and allied health professionals such as nurses, midwives, and pharmacists.
      - name: care_site_id
        description: This is the CARE_SITE_ID for the location that the provider primarily practices in.
      - name: year_of_birth
        description: The year of birth of the Provider.
      - name: gender_concept_id
        description: This field represents the recorded gender of the provider in the source data.
      - name: provider_source_value
        description: Use this field to link back to providers in the source data. This is typically used for error checking of ETL logic.
      - name: specialty_source_value
        description: This is the kind of provider or specialty as it appears in the source data. This includes physician specialties such as internal medicine, emergency medicine, etc. and allied health professionals such as nurses, midwives, and pharmacists.
      - name: specialty_source_concept_id
        description: This is often zero as many sites use proprietary codes to store physician speciality.
      - name: gender_source_value
        description: This is provider’s gender as it appears in the source data.
      - name: gender_source_concept_id
        description: This is often zero as many sites use proprietary codes to store provider gender.

  - name: note
    description: This table stores notes, such as clinical or medical notes, associated with persons in the database. Each note is uniquely identified and linked to various attributes like note type, class, and content.
    columns:
      - name: note_id
        description: A unique identifier for each note.
        tests:
          - unique
          - not_null
      - name: person_id
        description: The identifier for the person to whom the note belongs.
        tests:
          - not_null
      - name: note_date
        description: The date the note was recorded.
        tests:
          - not_null
      - name: note_datetime
        description: The precise datetime when the note was recorded. If time is not given, set to midnight.      
      - name: note_type_concept_id
        description: The provenance of the note, most likely from an EHR system. Indicates the source system of the note.
        tests:
          - not_null
      - name: note_class_concept_id
        description: A Standard Concept Id representing the HL7 LOINC Document Type Vocabulary classification of the note.
        tests:
          - not_null
      - name: note_title
        description: The title of the note.
      - name: note_text
        description: The content of the note.
        tests:
          - not_null
      - name: encoding_concept_id
        description: The Concept representing the character encoding type of the note, with UTF-8 (32678) as the standard.
        tests:
          - not_null
      - name: language_concept_id
        description: The language in which the note is written, using Concepts that are descendants of World Languages (4182347).
        tests:
          - not_null
      - name: provider_id
        description: The provider who authored the note. Determination of the specific provider may be required by the ETL process.
      - name: visit_occurrence_id
        description: The visit occurrence during which the note was written.
      - name: visit_detail_id
        description: The visit detail during which the note was written.
      - name: note_source_value
        description: The source value that is mapped to the NOTE_CLASS_CONCEPT_ID.
      - name: note_event_id
        description: If the note is related to another record in the database, this field holds the primary key of that linked record.
      - name: note_event_field_concept_id
        description: If the note is related to another record, this field identifies the table and field from which the NOTE_EVENT_ID originates.
